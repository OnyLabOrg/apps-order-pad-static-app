import{$ as r}from"./TranslationUtil-D6RbMuvh.js";import{D as u,u as w,a as O,d as V}from"./PriceUtil-H5ZYy_ri.js";import{u as T,h as D,c as I,_ as k}from"./AppSelectContext.vue_vue_type_script_setup_true_lang--LE9XDG8.js";import{_ as C}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-BEbfhSUg.js";import{c as o}from"./common-api.web.min-rTQUY9Dn.js";import H from"./card-order-details-Bi6AF26B.js";import{$ as E}from"./api-D86OEvv6.js";import{V as R,a as b}from"./VRow-Dwcgffu6.js";import{V as L}from"./VDataTable-DOLtLrBU.js";import{d as N,r as x,G as P,ai as B,c as q,b as s,f as a,m as i,o as z,e as n,v as l,aV as Y,ah as G,t as g,$ as U}from"./index-R4J3yP5x.js";import{V as Z}from"./VChip-DJ3-IoRz.js";import{V as j}from"./VAvatar-Dcut3IqL.js";import"./VSelect-DlrQBM1_.js";import"./VTextField-DsKkoxje.js";/* empty css                   */import"./VCounter-B0GjDfYL.js";import"./VImg-Cgujsypy.js";import"./VField-DJYRsepV.js";import"./form-msTXtFoO.js";import"./easing-Bybner-F.js";import"./VInput-CfYZXS1A.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-C1EbS1XE.js";import"./ssrBoot-lbtkSBDk.js";import"./VDivider-BEDhrYSm.js";import"./dialog-transition-6ev1hpXm.js";import"./VMenu-BBoJxPZ6.js";import"./VOverlay-DMVFm7VV.js";import"./delay-SFsLxMme.js";import"./lazy-COtXjFnv.js";import"./scopeId-6a-1aTCY.js";import"./VCheckboxBtn-D7WNZ2pJ.js";import"./VSelectionControl-DWfiMw8K.js";import"./VCard-DpI8T9dR.js";import"./VCardText-BzIuNRux.js";import"./VTable-CWxgwF-P.js";import"./VAlert-DDIakxDG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VSlideGroup-BLNseKNf.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VPagination-BEhZVOfh.js";import"./filter-ShdqcvYT.js";const F={class:"text-h4 mb-1"},M={class:"text-body-1"},J={class:"v-data-table__tr"},K=["colspan"],Q={class:"d-flex align-center"},W={class:"d-flex flex-column ms-3"},X={class:"d-flex align-center"},Ue=N({__name:"list",setup(ee){const A=u.local().toISODate(),y=[{key:"data-table-expand",title:""},{key:"service_type",title:r("page.order.list.header.serviceType")},{key:"ref",title:r("page.order.list.header.reference")},{key:"channel",title:r("page.order.list.header.channel")},{key:"expected_time",title:r("page.order.list.header.expectedTime")},{key:"total",title:r("page.order.list.header.total")},{key:"status",title:r("page.order.list.header.status")},{key:"created_at",title:r("page.order.list.header.createdAt")}],d=x(),m=x(`${u.local().toISODate()} > ${u.local().toISODate()}`),p=x(!1),f=e=>{switch(e){case o.Api.HubriseServiceType.DELIVERY:return{icon:"bx-cycling ",color:"info",text:r("page.order.list.serviceType.delivery")};case o.Api.HubriseServiceType.COLLECTION:return{icon:"bx-shopping-bag",color:"info",text:r("page.order.list.serviceType.pickup")};case o.Api.HubriseServiceType.EAT_IN:return{icon:"bx-table",color:"info",text:r("page.order.list.serviceType.eatIn")}}return{icon:"bx-question-mark",color:"error",text:r("page.order.list.serviceType.unknown")}},$=e=>{switch(e){case o.Api.HubriseOrderStatus.new:return{color:"info",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.received:return{color:"info",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.accepted:return{color:"info",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.in_preparation:return{color:"warning",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.awaiting_shipment:return{color:"warning",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.awaiting_collection:return{color:"warning",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.in_delivery:return{color:"warning",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.completed:return{color:"success",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.rejected:return{color:"error",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.cancelled:return{color:"error",text:r(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.delivery_failed:return{color:"error",text:r(`page.order.list.status.${String(e)}`)}}return{color:"error",text:r("page.order.list.status.unknown")}},_=()=>{const e=v.getCurrentLocation;if(typeof(e==null?void 0:e.id)!="string"){d.value=void 0;return}const c=m.value.split(">").map(t=>t.trim()),S=u.fromISO(c[0],{setZone:!0}).set({hour:0,minute:0,second:0,millisecond:0}).toISO(),h=u.fromISO(c[1]??c[0],{setZone:!0}).set({hour:23,minute:59,second:59,millisecond:999}).toISO();p.value=!0,E(`orderpad/orders?locationId=${e.id}&startDate=${S}&endDate=${h}`,{method:"GET",onResponseError({response:t}){d.value=[],p.value=!1,D(t)}}).then(t=>{d.value=t.orders,p.value=!1}).catch(t=>{d.value=[],p.value=!1,I(t)})},v=T();return P(()=>{w("page.order.list.title"),v.onCurrentLocationChange(_)}),B(()=>{v.offCurrentLocationChange(_)}),(e,c)=>{const S=C,h=k;return z(),q("div",null,[s(R,{class:"mb-3"},{default:a(()=>[s(b,{class:"d-flex gap-4 align-end flex-wrap",cols:"3"},{default:a(()=>[n("h4",F,l(("$t"in e?e.$t:i(r))("page.order.list.title")),1),n("div",M,l(("$t"in e?e.$t:i(r))("page.order.add.subtitle")),1)]),_:1}),s(b,{class:"d-inline-flex gap-4 align-end overflow-hidden",cols:"6"},{default:a(()=>[s(S,{modelValue:i(m),"onUpdate:modelValue":c[0]||(c[0]=t=>Y(m)?m.value=t:null),config:{mode:"single",enableTime:!1,noCalendar:!1,dateFormat:"Y-m-d",maxDate:i(A)},label:("$t"in e?e.$t:i(r))("page.order.list.selector.date.label"),clearable:"",style:{width:"250px"},variant:"underlined"},null,8,["modelValue","config","label"]),s(G,{disabled:!i(m),loading:i(p),size:"small",type:"button",onClick:_},{default:a(()=>[g(l(("$t"in e?e.$t:i(r))("page.order.list.selector.date.button")),1)]),_:1},8,["disabled","loading"])]),_:1}),s(b,{class:"d-flex gap-4 align-end flex-wrap",cols:"3"},{default:a(()=>[s(h,{"enable-locations":""})]),_:1})]),_:1}),s(L,{headers:y,items:i(d),"items-per-page":100,loading:i(p)||i(d)===void 0,"expand-on-click":"","fixed-header":"","hide-default-footer":"","loading-text":"common.component.loading","no-data-text":"common.component.noData"},{"expanded-row":a(t=>[n("tr",J,[n("td",{colspan:y.length,class:"pa-0"},[s(H,{order:t.item},null,8,["order"])],8,K)])]),"item.service_type":a(({item:t})=>[n("div",Q,[s(j,{color:f(t.service_type).color,size:"32",variant:"tonal"},{default:a(()=>[s(U,{icon:f(t.service_type).icon,class:"font-weight-medium"},null,8,["icon"])]),_:2},1032,["color"]),n("div",W,[n("small",null,l(f(t.service_type).text),1)])])]),"item.ref":a(({item:t})=>[n("div",X,l(t.ref)+l(t.private_ref),1)]),"item.total":a(({item:t})=>[g(l(("displayPrice"in e?e.displayPrice:i(V))(t.total)),1)]),"item.status":a(({item:t})=>[s(Z,{color:$(t.status).color,class:"font-weight-medium text-uppercase",size:"small"},{default:a(()=>[g(l($(t.status).text),1)]),_:2},1032,["color"])]),"item.expected_time":a(({item:t})=>[g(l(("displayISO"in e?e.displayISO:i(O))(t.expected_time)),1)]),"item.created_at":a(({item:t})=>[g(l(("displayISO"in e?e.displayISO:i(O))(t.created_at)),1)]),_:1},8,["items","loading"])])}}});export{Ue as default};
