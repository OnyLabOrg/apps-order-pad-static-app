import{bj as c,cs as p,ct as C,cu as L,b4 as r}from"./index-DIFpKYWh.js";import{$ as m}from"./TranslationUtil-BOeqGOMR.js";const h=()=>typeof window.navigator!="object"||typeof window.navigator.onLine!="boolean"?!0:window.navigator.onLine,f=()=>typeof document.hidden=="boolean"?document.hidden:typeof document.msHidden=="boolean"?document.msHidden:typeof document.webkitHidden=="boolean"?document.webkitHidden:!1;function u(t){return{all:t=t||new Map,on:function(e,s){var o=t.get(e);o?o.push(s):t.set(e,[s])},off:function(e,s){var o=t.get(e);o&&(s?o.splice(o.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var o=t.get(e);o&&o.slice().map(function(g){g(s)}),(o=t.get("*"))&&o.slice().map(function(g){g(e,s)})}}}const l=u(),v=c("userStore",{state:()=>({user:void 0}),getters:{getCurrentUser:t=>t.user},actions:{onCurrentUserChange(t){l.on("update:user",t),t(this.user)},offCurrentUserChange(t){l.off("update:user",t)},setCurrentUser(t){this.user=t,l.emit("update:user",this.user)},reset(){this.user=void 0,l.emit("update:user",this.user)}},persist:!0}),d=u(),w=c("accountStore",{state:()=>({account:void 0}),getters:{getCurrentAccount:t=>t.account},actions:{onCurrentAccountChange(t){d.on("update:account",t),t(this.account)},offCurrentAccountChange(t){d.off("update:account",t)},setCurrentAccount(t){this.account=t,d.emit("update:account",this.account)},reset(){this.account=void 0,d.emit("update:account",this.account)}},persist:!0}),a=u(),E=c("locationStore",{state:()=>({location:void 0,locations:void 0}),getters:{getCurrentLocation:t=>t.location,getLocations:t=>t.locations},actions:{onCurrentLocationChange(t){a.on("update:location",t),t(this.location)},offCurrentLocationChange(t){a.off("update:location",t)},onLocationsChange(t){a.on("update:locations",t),t(this.locations)},offLocationsChange(t){a.off("update:locations",t)},setCurrentLocation(t){this.location=t,a.emit("update:location",this.location)},setLocations(t){this.locations=t,a.emit("update:locations",this.locations)},reset(){this.location=void 0,a.emit("update:location",this.location),this.locations=void 0,a.emit("update:locations",this.locations)}},persist:!0}),i=u(),S=c("customerListStore",{state:()=>({customerList:void 0,customerLists:void 0}),getters:{getCurrentCustomerList:t=>t.customerList,getCustomerLists:t=>t.customerLists},actions:{onCurrentCustomerListChange(t){i.on("update:customerList",t),t(this.customerList)},offCurrentCustomerListChange(t){i.off("update:customerList",t)},onCustomerListsChange(t){i.on("update:customerLists",t),t(this.customerLists)},offCustomerListsChange(t){i.off("update:customerLists",t)},setCurrentCustomerList(t){this.customerList=t,i.emit("update:customerList",this.customerList)},setCustomerLists(t){this.customerLists=t,i.emit("update:customerLists",this.customerLists)},reset(){this.customerList=void 0,i.emit("update:customerList",this.customerList),this.customerLists=void 0,i.emit("update:customerLists",this.customerLists)}},persist:!0}),n=u(),y=c("catalogStore",{state:()=>({catalog:void 0,catalogs:void 0}),getters:{getCurrentCatalog:t=>t.catalog,getCatalogs:t=>t.catalogs},actions:{onCurrentCatalogChange(t){n.on("update:catalog",t),t(this.catalog)},offCurrentCatalogChange(t){n.off("update:catalog",t)},onCatalogsChange(t){n.on("update:catalogs",t),t(this.catalogs)},offCatalogsChange(t){n.off("update:catalogs",t)},setCurrentCatalog(t){this.catalog=t,n.emit("update:catalog",this.catalog)},setCatalogs(t){this.catalogs=t,n.emit("update:catalogs",this.catalogs)},reset(){this.catalog=void 0,n.emit("update:catalog",this.catalog),this.catalogs=void 0,n.emit("update:catalogs",this.catalogs)}},persist:!0});class b{static info(e,s){p(o=>{o.setExtra("context",Object.assign({isOnline:h(),isHidden:f()},s)),C(e)})}static exception(e){if(f()&&e.message!==void 0&&e.message!==null&&typeof e.message=="string"&&e.message.includes("timeout")||e.message!==void 0&&e.message!==null&&typeof e.message=="string"&&e.message.includes("status code 401"))return!1;p(s=>{s.setExtra("context",{isOnline:h(),isHidden:f()}),L(e)})}}const x=w(),H=v(),A=E(),U=S(),k=y(),O=async(t,e)=>{r("jwt",{domain:".apps.onylab.com"}).value=null,r("accessToken").value=null,r("userData").value=null,r("userAbilityRules").value=null,x.reset(),H.reset(),A.reset(),U.reset(),k.reset(),t!==void 0?await t.push("/login"):window.location.href="/",e!==void 0&&e.update([])},R=async(t,e)=>!h()||typeof t.message=="string"&&t.message.includes("Network Error")?m("common.error.offline"):typeof t.message=="string"&&t.message.includes("timeout")?m("common.error.timeout"):(b.exception(t),m("common.error.default")),q=async(t,e)=>{t.status===401&&await O();const s=new Error(t._data.message??"Request failed");return R(s)};export{R as a,w as b,E as c,S as d,y as e,q as h,O as l,v as u};
