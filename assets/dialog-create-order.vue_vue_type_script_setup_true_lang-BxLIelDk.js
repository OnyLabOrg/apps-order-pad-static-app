import{$ as l}from"./TranslationUtil-BOeqGOMR.js";import{_ as B}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-BEiT3FiF.js";import{c as E,d as N,h as A,a as D}from"./Http-DoewKbdi.js";import{$ as T}from"./api-BJExBwSI.js";import{V as j}from"./VDialog-D2t4AOhY.js";import{V as q}from"./VCard-BKFQ2T24.js";import{V as v}from"./VCardText-Dej1mPRB.js";import{d as P,r as V,w as U,g as c,f as i,m as t,aV as z,o as u,l as m,b as f,b9 as F,t as $,v as y,ah as k}from"./index-DIFpKYWh.js";const Y=P({__name:"dialog-create-order",props:{order:{type:Object,default:()=>{}}},emits:["done"],setup(L,{emit:w}){const C=L,_=w,S=E(),I=N(),h=V({}),n=V(!1),r=V(!0),p=()=>{r.value=!1,_("done")},O=e=>{Array.isArray(e.items)&&(e.items=e.items.filter(o=>{var s;return o.options=(s=o.options)==null?void 0:s.filter(a=>"id"in a&&a.id!==void 0&&a.id!==null),"id"in o&&o.id!==void 0&&o.id!==null}))},R=e=>{var a,b;const o=(a=S.getCurrentLocation)==null?void 0:a.id;if(o===void 0)return;const s=(b=I.getCurrentCustomerList)==null?void 0:b.id;s!==void 0&&(r.value=!0,O(e),T("orderpad/order",{method:"POST",body:{locationId:o,customerListId:s,...e},onResponseError({response:d}){A(d),p()}}).then(d=>{h.value=d.order,p()}).catch(d=>{D(d),p()}))},g=()=>{console.log("reset"),n.value=!1,r.value=!1,window.location.reload()};return U(()=>C.order,()=>{console.log("init"),n.value=!0,r.value=!0,R(C.order)}),(e,o)=>{const s=B;return u(),c(j,{modelValue:t(n),"onUpdate:modelValue":o[0]||(o[0]=a=>z(n)?n.value=a:null),persistent:t(r),class:"v-dialog-sm","onClick:outside":g},{default:i(()=>[t(r)?m("",!0):(u(),c(s,{key:0,onClick:g})),f(q,{color:t(r)?"primary":"white",title:t(r)?("$t"in e?e.$t:t(l))("page.order.add.section.create.creating.title"):("$t"in e?e.$t:t(l))("page.order.add.section.create.created.title")},{default:i(()=>[t(r)?(u(),c(v,{key:0,class:"pt-3 text-white"},{default:i(()=>[f(F,{"bg-color":"rgba(var(--v-theme-surface), 0.1)",class:"mb-0 mt-4",color:"#fff",indeterminate:""})]),_:1})):m("",!0),t(r)?m("",!0):(u(),c(v,{key:1},{default:i(()=>[$(y(("$t"in e?e.$t:t(l))("page.order.add.section.create.created.description",{orderName:t(h).ref})),1)]),_:1})),t(r)?m("",!0):(u(),c(v,{key:2,class:"d-flex justify-end gap-3 flex-wrap"},{default:i(()=>[f(k,{to:{name:"order-list"},color:"secondary",variant:"tonal"},{default:i(()=>[$(y(("$t"in e?e.$t:t(l))("page.order.add.section.create.button.orders")),1)]),_:1}),f(k,{onClick:g},{default:i(()=>[$(y(("$t"in e?e.$t:t(l))("page.order.add.section.create.button.validate")),1)]),_:1})]),_:1}))]),_:1},8,["color","title"])]),_:1},8,["modelValue","persistent"])}}});export{Y as _};
