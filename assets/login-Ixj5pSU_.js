import"./validators-BJEf8OaU.js";import{_ as R}from"./AppTextField.vue_vue_type_script_setup_true_lang-Ns0gJAy7.js";import{a as B,b as $}from"./auth-v1-top-shape-0NcaQZ_m.js";import{V as u}from"./VNodeRenderer-BJnDy_A5.js";import{d as q,r as d,u as P,j as S,b5 as r,bd as D,a$ as v,a as F,c as L,o as j,e as s,b as o,m as t,L as y,f as l,H as p,v as C,t as k,l as E,x as U}from"./index-IocJxrYA.js";import{u as M}from"./useAbility-CxgK4Eul.js";import{$ as H}from"./api-BmZLpE-D.js";import{C as _}from"./constants-CCDRJ4Ay.js";import{a as I,c as O,V as z}from"./VCard-BD5MO7Gs.js";import{V as g}from"./VCardText-CZs76tDv.js";import"./VRow-D3QwLY3Y.js";import"./VCheckbox-eMkWtI0L.js";import"./VDivider-CLIbkeVQ.js";import"./helpers-BGv4x_9E.js";import"./form-Bog-j-sp.js";import"./VTextField-xbfcSgPx.js";/* empty css                   */import"./VCounter-D326evJ5.js";import"./VImg-nllyqj75.js";import"./VField-DE-VLrGD.js";import"./easing-Bybner-F.js";import"./VInput-C6ccFH0D.js";import"./forwardRefs-C-GTDzx5.js";import"./index-CvOPxmL5.js";import"./VAvatar-DhK3kmAQ.js";/* empty css              */import"./VCheckboxBtn-cbcrrDeI.js";import"./VSelectionControl-DAP74g5K.js";const G={class:"auth-wrapper d-flex align-center justify-center pa-4"},K={class:"position-relative my-sm-16"},W={class:"app-logo"},X={class:"app-logo-title"},Y={class:"text-h4 mb-1"},J={class:"text-capitalize"};const Fe=q({__name:"login",async setup(Q){let f,V;const Z=d(!1),c=P(),h=S(),x=M(),N=d({email:void 0,password:void 0}),T=d(),b=d({email:"",password:"",remember:!1}),A=async()=>{try{const e=await H("/auth/login",{method:"POST",body:{email:b.value.email,password:b.value.password},onResponseError({response:n}){N.value=n._data.errors}}),{accessToken:a,userData:i,userAbilityRules:m}=e;r("userAbilityRules",{maxAge:_}).value=m,x.update(m),r("userData",{maxAge:_}).value=i,r("accessToken",{maxAge:_}).value=a,await v(()=>{h.replace(c.query.to?String(c.query.to):"/")})}catch(e){console.error(e)}},ee=()=>{var e;(e=T.value)==null||e.validate().then(({valid:a})=>{a&&A()})},w=r("jwt").value;if(typeof w=="string"){const e=w,a=[{action:"manage",subject:"all"}],i={id:1,fullName:"",username:"",avatar:"/images/avatars/avatar.png",email:"",role:"admin"};r("userAbilityRules",{}).value=a,x.update(a),r("userData").value=i,r("accessToken").value=e,[f,V]=D(()=>v(()=>{h.replace(c.query.to?String(c.query.to):"/")})),await f,V()}else window.location.href="https://login.apps.onylab.com/auth/?app=orderpad";return(e,a)=>{const i=F("RouterLink"),m=R;return j(),L("div",G,[s("div",K,[o(t(u),{nodes:("h"in e?e.h:t(y))("div",{innerHTML:t(B)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),o(t(u),{nodes:("h"in e?e.h:t(y))("div",{innerHTML:t($)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),o(z,{class:U([e.$vuetify.display.smAndUp?"pa-6":"pa-0","auth-card"]),"max-width":"460"},{default:l(()=>[o(I,{class:"justify-center"},{default:l(()=>[o(O,null,{default:l(()=>[o(i,{to:"/"},{default:l(()=>[s("div",W,[o(t(u),{nodes:t(p).app.logo},null,8,["nodes"]),s("h1",X,C(t(p).app.title),1)])]),_:1})]),_:1})]),_:1}),o(g,null,{default:l(()=>[s("h4",Y,[a[4]||(a[4]=k(" Welcome to ")),s("span",J,C(t(p).app.title),1),a[5]||(a[5]=k("! 👋🏻 "))]),a[6]||(a[6]=s("p",{class:"mb-0"},null,-1))]),_:1,__:[6]}),o(g,null,{default:l(()=>[E("",!0)]),_:1})]),_:1},8,["class"])])])}}});export{Fe as default};
