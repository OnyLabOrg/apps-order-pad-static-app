import{$ as u}from"./TranslationUtil-pdlYL3up.js";import{_ as R}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-BfvDJIHG.js";import{c as B,d as E,h as N,a as A}from"./Http-zN6zsM5q.js";import{$ as D}from"./api-DasSzC_v.js";import{V as T}from"./VDialog-CyB8WYM8.js";import{V as j}from"./VCard-vHX5ehuX.js";import{V as g}from"./VCardText-BWHcqFBT.js";import{d as q,r as v,w as P,g as l,f as i,m as t,aV as U,o as c,l as m,b as V,b9 as x,t as h,v as k,ah as z}from"./index-DOdbB806.js";const X=q({__name:"dialog-create-order",props:{order:{type:Object,default:()=>{}}},emits:["done"],setup(L,{emit:b}){const C=L,w=b,_=B(),S=E(),y=v({}),n=v(!1),r=v(!0),f=()=>{r.value=!1,w("done")},I=e=>{Array.isArray(e.items)&&(e.items=e.items.filter(o=>{var s;return o.options=(s=o.options)==null?void 0:s.filter(a=>"id"in a&&a.id!==void 0&&a.id!==null),"id"in o&&o.id!==void 0&&o.id!==null}))},O=e=>{var a,$;const o=(a=_.getCurrentLocation)==null?void 0:a.id;if(o===void 0)return;const s=($=S.getCurrentCustomerList)==null?void 0:$.id;s!==void 0&&(r.value=!0,I(e),D("orderpad/order",{method:"POST",body:{locationId:o,customerListId:s,...e},onResponseError({response:d}){N(d),f()}}).then(d=>{y.value=d.order,f()}).catch(d=>{A(d),f()}))},p=()=>{console.log("reset"),n.value=!1,r.value=!1,window.location.reload()};return P(()=>C.order,()=>{console.log("init"),n.value=!0,r.value=!0,O(C.order)}),(e,o)=>{const s=R;return c(),l(T,{modelValue:t(n),"onUpdate:modelValue":o[0]||(o[0]=a=>U(n)?n.value=a:null),persistent:t(r),class:"v-dialog-sm","onClick:outside":p},{default:i(()=>[t(r)?m("",!0):(c(),l(s,{key:0,onClick:p})),V(j,{color:t(r)?"primary":"white",title:t(r)?("$t"in e?e.$t:t(u))("page.order.add.section.create.creating.title"):("$t"in e?e.$t:t(u))("page.order.add.section.create.created.title")},{default:i(()=>[t(r)?(c(),l(g,{key:0,class:"pt-3 text-white"},{default:i(()=>[V(x,{"bg-color":"rgba(var(--v-theme-surface), 0.1)",class:"mb-0 mt-4",color:"#fff",indeterminate:""})]),_:1})):m("",!0),t(r)?m("",!0):(c(),l(g,{key:1},{default:i(()=>[h(k(("$t"in e?e.$t:t(u))("page.order.add.section.create.created.description",{orderName:t(y).ref})),1)]),_:1})),t(r)?m("",!0):(c(),l(g,{key:2,class:"d-flex justify-end gap-3 flex-wrap"},{default:i(()=>[V(z,{onClick:p},{default:i(()=>[h(k(("$t"in e?e.$t:t(u))("page.order.add.section.create.button.validate")),1)]),_:1})]),_:1}))]),_:1},8,["color","title"])]),_:1},8,["modelValue","persistent"])}}});export{X as _};
