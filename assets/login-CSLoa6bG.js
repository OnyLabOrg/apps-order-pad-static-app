import"./validators-BJEf8OaU.js";import{_ as R}from"./AppTextField.vue_vue_type_script_setup_true_lang-CiU16BnH.js";import{a as B,b as $}from"./auth-v1-top-shape-0NcaQZ_m.js";import{V as u}from"./VNodeRenderer-DWE_oip7.js";import{d as q,r as d,u as S,j as P,aY as r,b4 as D,aS as v,a as F,c as j,o as E,e as s,b as o,m as t,J as y,f as l,E as p,v as C,t as g,l as L,x as U,dg as _}from"./index-S43cw9oA.js";import{u as M}from"./useAbility-QCgKtjp_.js";import{$ as I}from"./api-phkBy03g.js";import{a as O,c as z,V as H}from"./VCard-CO8V5xCG.js";import{V as k}from"./VCardText-C2EK2BY0.js";import"./VRow-fWKubFJU.js";import"./VCheckbox-CtOOK0hq.js";import"./VDivider-64nIFpK2.js";import"./helpers-BGv4x_9E.js";import"./form-DhdRurvO.js";import"./VTextField-BU3AMPjT.js";/* empty css                   */import"./VCounter-C1wRTfE3.js";import"./VImg-ULZRPAmZ.js";import"./VField-Bi2rqcJt.js";import"./easing-Bybner-F.js";import"./VInput-C3yAXQ_X.js";import"./forwardRefs-C-GTDzx5.js";import"@vueuse/core";import"./index-CvOPxmL5.js";import"./VAvatar-BblF4_hD.js";/* empty css              */import"./VCheckboxBtn-B1A3zfym.js";import"./VSelectionControl-zcFFnStE.js";const Y={class:"auth-wrapper d-flex align-center justify-center pa-4"},G={class:"position-relative my-sm-16"},J={class:"app-logo"},K={class:"app-logo-title"},W={class:"text-h4 mb-1"},X={class:"text-capitalize"};const Fe=q({__name:"login",async setup(Q){let f,V;const Z=d(!1),c=S(),h=P(),x=M(),N=d({email:void 0,password:void 0}),T=d(),b=d({email:"",password:"",remember:!1}),A=async()=>{try{const e=await I("/auth/login",{method:"POST",body:{email:b.value.email,password:b.value.password},onResponseError({response:n}){N.value=n._data.errors}}),{accessToken:a,userData:i,userAbilityRules:m}=e;r("userAbilityRules",{maxAge:_}).value=m,x.update(m),r("userData",{maxAge:_}).value=i,r("accessToken",{maxAge:_}).value=a,await v(()=>{h.replace(c.query.to?String(c.query.to):"/")})}catch(e){console.error(e)}},ee=()=>{var e;(e=T.value)==null||e.validate().then(({valid:a})=>{a&&A()})},w=r("jwt").value;if(typeof w=="string"){const e=w,a=[{action:"manage",subject:"all"}],i={id:1,fullName:"",username:"",avatar:"/images/avatars/avatar.png",email:"",role:"admin"};r("userAbilityRules",{}).value=a,x.update(a),r("userData").value=i,r("accessToken").value=e,[f,V]=D(()=>v(()=>{h.replace(c.query.to?String(c.query.to):"/")})),await f,V()}else window.location.href="https://login.apps.onylab.com/auth/?app=orderpad";return(e,a)=>{const i=F("RouterLink"),m=R;return E(),j("div",Y,[s("div",G,[o(t(u),{nodes:("h"in e?e.h:t(y))("div",{innerHTML:t(B)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),o(t(u),{nodes:("h"in e?e.h:t(y))("div",{innerHTML:t($)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),o(H,{class:U([e.$vuetify.display.smAndUp?"pa-6":"pa-0","auth-card"]),"max-width":"460"},{default:l(()=>[o(O,{class:"justify-center"},{default:l(()=>[o(z,null,{default:l(()=>[o(i,{to:"/"},{default:l(()=>[s("div",J,[o(t(u),{nodes:t(p).app.logo},null,8,["nodes"]),s("h1",K,C(t(p).app.title),1)])]),_:1})]),_:1})]),_:1}),o(k,null,{default:l(()=>[s("h4",W,[a[4]||(a[4]=g(" Welcome to ")),s("span",X,C(t(p).app.title),1),a[5]||(a[5]=g("! ðŸ‘‹ðŸ» "))]),a[6]||(a[6]=s("p",{class:"mb-0"},null,-1))]),_:1,__:[6]}),o(k,null,{default:l(()=>[L("",!0)]),_:1})]),_:1},8,["class"])])])}}});export{Fe as default};
