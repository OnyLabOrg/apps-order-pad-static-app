import{$ as d}from"./TranslationUtil-CFKlA-R8.js";import{b4 as B,d as N,r as g,G as j,c as z,F as H,g as V,l as k,m as l,o as b}from"./index-VpTvokrT.js";import{m as G,h as $,a as E}from"./Http-t4QOkopC.js";import{$ as S}from"./api-DW5B9yTY.js";import{V as R}from"./VSelect-CcJjGJ91.js";const r=G(),J=B("locationStore",{state:()=>({location:void 0,locations:void 0}),getters:{getCurrentLocation:t=>t.location,getLocations:t=>t.locations},actions:{onCurrentLocationChange(t){r.on("update:location",t),t(this.location)},offCurrentLocationChange(t){r.off("update:location",t)},onLocationsChange(t){r.on("update:locations",t),t(this.locations)},offLocationsChange(t){r.off("update:locations",t)},setCurrentLocation(t){this.location=t,r.emit("update:location",this.location)},setLocations(t){this.locations=t,r.emit("update:locations",this.locations)},reset(){this.location=void 0,r.emit("update:location",this.location),this.locations=void 0,r.emit("update:locations",this.locations)}},persist:!0}),u=G(),K=B("customerListStore",{state:()=>({customerList:void 0,customerLists:void 0}),getters:{getCurrentCustomerList:t=>t.customerList,getCustomerLists:t=>t.customerLists},actions:{onCurrentCustomerListChange(t){u.on("update:customerList",t),t(this.customerList)},offCurrentCustomerListChange(t){u.off("update:customerList",t)},onCustomerListsChange(t){u.on("update:customerLists",t),t(this.customerLists)},offCustomerListsChange(t){u.off("update:customerLists",t)},setCurrentCustomerList(t){this.customerList=t,u.emit("update:customerList",this.customerList)},setCustomerLists(t){this.customerLists=t,u.emit("update:customerLists",this.customerLists)},reset(){this.customerList=void 0,u.emit("update:customerList",this.customerList),this.customerLists=void 0,u.emit("update:customerLists",this.customerLists)}},persist:!0}),c=G(),O=B("catalogStore",{state:()=>({catalog:void 0,catalogs:void 0}),getters:{getCurrentCatalog:t=>t.catalog,getCatalogs:t=>t.catalogs},actions:{onCurrentCatalogChange(t){c.on("update:catalog",t),t(this.catalog)},offCurrentCatalogChange(t){c.off("update:catalog",t)},onCatalogsChange(t){c.on("update:catalogs",t),t(this.catalogs)},offCatalogsChange(t){c.off("update:catalogs",t)},setCurrentCatalog(t){this.catalog=t,c.emit("update:catalog",this.catalog)},setCatalogs(t){this.catalogs=t,c.emit("update:catalogs",this.catalogs)},reset(){this.catalog=void 0,c.emit("update:catalog",this.catalog),this.catalogs=void 0,c.emit("update:catalogs",this.catalogs)}},persist:!0}),Z=N({__name:"AppSelectContext",props:{enableLocations:{type:Boolean,default:()=>!1},enableCustomerLists:{type:Boolean,default:()=>!1},enableCatalogs:{type:Boolean,default:()=>!1}},setup(t){const y=t,T=g(y.enableLocations),w=g(y.enableCustomerLists),D=g(y.enableCatalogs),s=J(),n=K(),i=O(),m=g(),C=g(),p=g();m.value=s.getCurrentLocation,C.value=n.getCurrentCustomerList,p.value=i.getCurrentCatalog;const h=e=>{var a;typeof e=="string"&&(e=((a=n.getCustomerLists)==null?void 0:a.find(o=>o.id===e))??null),e!==null&&(n.setCurrentCustomerList(e),C.value=n.getCurrentCustomerList)},f=e=>{var a;typeof e=="string"&&(e=((a=i.getCatalogs)==null?void 0:a.find(o=>o.id===e))??null),e!==null&&S(`catalog?catalogId=${e.id}`,{method:"GET",onResponseError({response:o}){i.setCurrentCatalog(void 0),$(o)}}).then(o=>{i.setCurrentCatalog(o.catalog)}).catch(o=>{i.setCurrentCatalog(void 0),E(o)})},I=()=>{var e,a;D.value&&(i.getCatalogs===void 0?(i.setCatalogs(void 0),S(`catalogs?locationId=${(e=s.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:o}){$(o)}}).then(o=>{var L;i.setCatalogs(o.catalogs),((L=i.getCatalogs)==null?void 0:L.length)===1&&f(i.getCatalogs[0])}).catch(o=>{E(o)})):i.getCurrentCatalog!==void 0?f(i.getCurrentCatalog):((a=i.getCatalogs)==null?void 0:a.length)===1&&f(i.getCatalogs[0]))},U=()=>{var e,a;w.value&&(n.getCustomerLists===void 0?(n.setCustomerLists(void 0),S(`customers/list?locationId=${(e=s.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:o}){$(o)}}).then(o=>{var L;n.setCustomerLists(o.lists),((L=n.getCustomerLists)==null?void 0:L.length)===1&&h(n.getCustomerLists[0])}).catch(o=>{E(o)})):n.getCurrentCustomerList!==void 0?h(n.getCurrentCustomerList):((a=n.getCustomerLists)==null?void 0:a.length)===1&&h(n.getCustomerLists[0]))},v=e=>{var a;typeof e=="string"&&(e=((a=s.getLocations)==null?void 0:a.find(o=>o.id===e))??null),e!==null&&(e!==s.getCurrentLocation?(s.setCurrentLocation(e),m.value=s.getCurrentLocation,F(),A()):(U(),I()))},q=()=>{s.setLocations(void 0),S("locations",{method:"GET",onResponseError({response:e}){$(e)}}).then(e=>{var a;s.setLocations(e.locations),((a=s.getLocations)==null?void 0:a.length)===1&&v(s.getLocations[0])}).catch(e=>{E(e)})},M=()=>{m.value=void 0,s.reset(),q()},F=()=>{C.value=void 0,n.reset(),U()},A=()=>{p.value=void 0,i.reset(),I()};return j(()=>{var e;T.value&&(s.getLocations===void 0?q():s.getCurrentLocation!==void 0?v(s.getCurrentLocation):((e=s.getLocations)==null?void 0:e.length)===1&&v(s.getLocations[0]))}),(e,a)=>(b(),z(H,null,[T.value?(b(),V(R,{key:0,modelValue:m.value,"onUpdate:modelValue":[a[0]||(a[0]=o=>m.value=o),v],disabled:l(s).getLocations===void 0,items:l(s).getLocations,label:("$t"in e?e.$t:l(d))("page.order.add.button.location.label"),loading:l(s).getLocations===void 0,placeholder:("$t"in e?e.$t:l(d))("page.order.add.button.location.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":M},null,8,["modelValue","disabled","items","label","loading","placeholder"])):k("",!0),w.value?(b(),V(R,{key:1,modelValue:C.value,"onUpdate:modelValue":[a[1]||(a[1]=o=>C.value=o),h],disabled:l(n).getCustomerLists===void 0,items:l(n).getCustomerLists,label:("$t"in e?e.$t:l(d))("page.order.add.button.customerList.label"),loading:l(n).getCustomerLists===void 0,placeholder:("$t"in e?e.$t:l(d))("page.order.add.button.customerList.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":F},null,8,["modelValue","disabled","items","label","loading","placeholder"])):k("",!0),D.value?(b(),V(R,{key:2,modelValue:p.value,"onUpdate:modelValue":[a[2]||(a[2]=o=>p.value=o),f],disabled:l(i).getCatalogs===void 0,items:l(i).getCatalogs,label:("$t"in e?e.$t:l(d))("page.order.add.button.catalog.label"),loading:l(i).getCatalogs===void 0,placeholder:("$t"in e?e.$t:l(d))("page.order.add.button.catalog.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":A},null,8,["modelValue","disabled","items","label","loading","placeholder"])):k("",!0)],64))}});export{Z as _,K as a,O as b,J as u};
