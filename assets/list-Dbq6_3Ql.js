import{$ as t}from"./TranslationUtil-vQAEikw1.js";import{d as V}from"./PriceUtil-DvnBaj4j.js";import{D as g,d as A}from"./DateUtil-klSeJugN.js";import{_ as I}from"./AppSelectContext.vue_vue_type_script_setup_true_lang-DSn4-wUx.js";import{_ as T}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-CCVr7Dpo.js";import{c as a}from"./common-api.web.min-7qNUJA33.js";import{u as D}from"./usePageTitle-CoYN_ZZk.js";import{a as k}from"./catalog-DT6x3Q5_.js";import C from"./card-order-details-tNSgRSsq.js";import{$ as H}from"./api--M5r_K7I.js";import{h as E,a as R}from"./Http-B4sICowL.js";import{V as L,a as b}from"./VRow-VezEptOs.js";import{V as P}from"./VDataTable-DD4s2kZf.js";import{d as N,r as x,G as U,ai as B,c as q,b as s,f as i,m as o,o as z,e as l,v as n,aV as Y,ah as G,t as f,$ as Z}from"./index-o4a1sI4k.js";import{V as j}from"./VChip-B2P-xJ8E.js";import{V as F}from"./VAvatar-Dyqv6hcE.js";import"./VSelect-DuVFzrp-.js";import"./VTextField-DiCKTh3S.js";/* empty css                   */import"./VCounter-B1D2V8OY.js";import"./transition-CIiqPMUq.js";import"./VField-C_IofqpS.js";import"./form-Dn68FyQH.js";import"./easing-Bybner-F.js";import"./VInput-DBOhK8LO.js";import"./forwardRefs-C-GTDzx5.js";import"./VImg-D73hFsYD.js";import"./VList-DrZUvHom.js";import"./ssrBoot-BiRDhVoJ.js";import"./VDivider-DDSHMm_H.js";import"./dialog-transition-f573BV8n.js";import"./VMenu-Dg5THk6-.js";import"./VOverlay-dy5jtK1n.js";import"./delay-CsCsVled.js";import"./lazy-DgFfqA1b.js";import"./scopeId-CUCtnjvn.js";import"./VCheckboxBtn-CbzUOAmq.js";import"./VSelectionControl-C_KuGuWe.js";import"./mitt-DJ65BbbF.js";import"./VCard-QeC16A5w.js";import"./VCardText-vbg2xMPi.js";import"./VTable-UrBE-DmI.js";import"./VAlert-BVyvqqs6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VSlideGroup--cqxJHsU.js";/* empty css              */import"./index-CvOPxmL5.js";import"./alert-B_b3sfes.js";import"./VPagination-Dxk8op4l.js";import"./filter-DlSa7AOC.js";const M={class:"text-h4 mb-1"},J={class:"text-body-1"},K={class:"v-data-table__tr"},Q=["colspan"],W={class:"d-flex align-center"},X={class:"d-flex flex-column ms-3"},ee={class:"d-flex align-center"},We=N({__name:"list",setup(te){const w=g.local().toISODate(),$=[{key:"data-table-expand",title:""},{key:"service_type",title:t("page.order.list.header.serviceType")},{key:"ref",title:t("page.order.list.header.reference")},{key:"channel",title:t("page.order.list.header.channel")},{key:"expected_time",title:t("page.order.list.header.expectedTime")},{key:"total",title:t("page.order.list.header.total")},{key:"status",title:t("page.order.list.header.status")},{key:"created_at",title:t("page.order.list.header.createdAt")}],p=x(),u=x(`${g.local().toISODate()} > ${g.local().toISODate()}`),c=x(!1),v=e=>{switch(e){case a.Api.HubriseServiceType.DELIVERY:return{icon:"bx-cycling ",color:"info",text:t("page.order.list.serviceType.delivery")};case a.Api.HubriseServiceType.COLLECTION:return{icon:"bx-shopping-bag",color:"info",text:t("page.order.list.serviceType.pickup")};case a.Api.HubriseServiceType.EAT_IN:return{icon:"bx-table",color:"info",text:t("page.order.list.serviceType.eatIn")}}return{icon:"bx-question-mark",color:"error",text:t("page.order.list.serviceType.unknown")}},O=e=>{switch(e){case a.Api.HubriseOrderStatus.new:return{color:"info",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.received:return{color:"info",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.accepted:return{color:"info",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.in_preparation:return{color:"warning",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.awaiting_shipment:return{color:"warning",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.awaiting_collection:return{color:"warning",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.in_delivery:return{color:"warning",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.completed:return{color:"success",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.rejected:return{color:"error",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.cancelled:return{color:"error",text:t(`page.order.list.status.${String(e)}`)};case a.Api.HubriseOrderStatus.delivery_failed:return{color:"error",text:t(`page.order.list.status.${String(e)}`)}}return{color:"error",text:t("page.order.list.status.unknown")}},h=()=>{const e=y.getCurrentLocation;if(typeof(e==null?void 0:e.id)!="string"){p.value=void 0;return}const m=u.value.split(">").map(d=>d.trim()),S=g.fromISO(m[0],{setZone:!0}).set({hour:0,minute:0,second:0,millisecond:0}).toISO(),_=g.fromISO(m[1]??m[0],{setZone:!0}).set({hour:23,minute:59,second:59,millisecond:999}).toISO(),r=new URLSearchParams;r.append("locationId",e.id),typeof S=="string"&&r.append("startDate",encodeURIComponent(S)),typeof _=="string"&&r.append("endDate",encodeURIComponent(_)),c.value=!0,H(`orderpad/orders?${r.toString()}`,{method:"GET",onResponseError({response:d}){p.value=[],c.value=!1,E(d)}}).then(d=>{p.value=d.orders,c.value=!1}).catch(d=>{p.value=[],c.value=!1,R(d)})},y=k();return U(()=>{D("page.order.list.title"),y.onCurrentLocationChange(h)}),B(()=>{y.offCurrentLocationChange(h)}),(e,m)=>{const S=T,_=I;return z(),q("div",null,[s(L,{class:"mb-3"},{default:i(()=>[s(b,{class:"d-flex gap-4 align-end flex-wrap",cols:"3"},{default:i(()=>[l("h4",M,n(("$t"in e?e.$t:o(t))("page.order.list.title")),1),l("div",J,n(("$t"in e?e.$t:o(t))("page.order.add.subtitle")),1)]),_:1}),s(b,{class:"d-inline-flex gap-4 align-end overflow-hidden",cols:"6"},{default:i(()=>[s(S,{modelValue:o(u),"onUpdate:modelValue":m[0]||(m[0]=r=>Y(u)?u.value=r:null),config:{mode:"single",enableTime:!1,noCalendar:!1,dateFormat:"Y-m-d",maxDate:o(w)},label:("$t"in e?e.$t:o(t))("page.order.list.selector.date.label"),clearable:"",style:{width:"250px"},variant:"underlined"},null,8,["modelValue","config","label"]),s(G,{disabled:!o(u),loading:o(c),size:"small",type:"button",onClick:h},{default:i(()=>[f(n(("$t"in e?e.$t:o(t))("page.order.list.selector.date.button")),1)]),_:1},8,["disabled","loading"])]),_:1}),s(b,{class:"d-flex gap-4 align-end flex-wrap",cols:"3"},{default:i(()=>[s(_,{"enable-locations":""})]),_:1})]),_:1}),s(P,{headers:$,items:o(p),"items-per-page":100,loading:o(c)||o(p)===void 0,"expand-on-click":"","fixed-header":"","hide-default-footer":"","loading-text":"common.component.loading","no-data-text":"common.component.noData"},{"expanded-row":i(r=>[l("tr",K,[l("td",{colspan:$.length,class:"pa-0"},[s(C,{order:r.item},null,8,["order"])],8,Q)])]),"item.service_type":i(({item:r})=>[l("div",W,[s(F,{color:v(r.service_type).color,size:"32",variant:"tonal"},{default:i(()=>[s(Z,{icon:v(r.service_type).icon,class:"font-weight-medium"},null,8,["icon"])]),_:2},1032,["color"]),l("div",X,[l("small",null,n(v(r.service_type).text),1)])])]),"item.ref":i(({item:r})=>[l("div",ee,n(r.ref)+n(r.private_ref),1)]),"item.total":i(({item:r})=>[f(n(("displayPrice"in e?e.displayPrice:o(V))(r.total)),1)]),"item.status":i(({item:r})=>[s(j,{color:O(r.status).color,class:"font-weight-medium text-uppercase",size:"small"},{default:i(()=>[f(n(O(r.status).text),1)]),_:2},1032,["color"])]),"item.expected_time":i(({item:r})=>[f(n(("displayISO"in e?e.displayISO:o(A))(r.expected_time)||("$t"in e?e.$t:o(t))("page.order.list.asap")),1)]),"item.created_at":i(({item:r})=>[f(n(("displayISO"in e?e.displayISO:o(A))(r.created_at)),1)]),_:1},8,["items","loading"])])}}});export{We as default};
