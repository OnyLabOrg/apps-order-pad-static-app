import{$ as i}from"./TranslationUtil-pdlYL3up.js";import{c as U,d as q,e as F,h as v,a as L}from"./Http-zN6zsM5q.js";import{$ as f}from"./api-DasSzC_v.js";import{V as $}from"./VSelect-tMlDkMau.js";import{d as A,r as d,G as M,c as N,o as b,F as j,g as y,l as V,m as n}from"./index-DOdbB806.js";const P=A({__name:"AppSelectContext",props:{enableLocations:{type:Boolean,default:()=>!1},enableCustomerLists:{type:Boolean,default:()=>!1},enableCatalogs:{type:Boolean,default:()=>!1}},setup(D){const h=D,E=d(h.enableLocations),S=d(h.enableCustomerLists),k=d(h.enableCatalogs),l=U(),s=q(),a=F(),u=d(),g=d(),r=d();u.value=l.getCurrentLocation,g.value=s.getCurrentCustomerList,r.value=a.getCurrentCatalog;const c=e=>{var o;typeof e=="string"&&(e=((o=s.getCustomerLists)==null?void 0:o.find(t=>t.id===e))??null),e!==null&&(s.setCurrentCustomerList(e),g.value=s.getCurrentCustomerList)},m=e=>{var o;if(typeof e=="string"&&(e=((o=a.getCatalogs)==null?void 0:o.find(t=>t.id===e))??null),e!==null){if(e.data!==void 0){a.setCurrentCatalog(e),r.value=a.getCurrentCatalog;return}f(`catalog?catalogId=${e.id}`,{method:"GET",onResponseError({response:t}){a.setCurrentCatalog(void 0),v(t)}}).then(t=>{a.setCurrentCatalog(t.catalog),r.value=a.getCurrentCatalog,e.data=t.catalog.data}).catch(t=>{a.setCurrentCatalog(void 0),L(t)})}},R=()=>{var e,o;k.value&&(a.getCatalogs===void 0?(a.setCatalogs(void 0),f(`catalogs?locationId=${(e=l.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:t}){v(t)}}).then(t=>{var C;a.setCatalogs(t.catalogs),((C=a.getCatalogs)==null?void 0:C.length)===1&&m(a.getCatalogs[0])}).catch(t=>{L(t)})):a.getCurrentCatalog!==void 0?m(a.getCurrentCatalog):((o=a.getCatalogs)==null?void 0:o.length)===1&&m(a.getCatalogs[0]))},B=()=>{var e,o;S.value&&(s.getCustomerLists===void 0?(s.setCustomerLists(void 0),f(`customers/list?locationId=${(e=l.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:t}){v(t)}}).then(t=>{var C;s.setCustomerLists(t.lists),((C=s.getCustomerLists)==null?void 0:C.length)===1&&c(s.getCustomerLists[0])}).catch(t=>{L(t)})):s.getCurrentCustomerList!==void 0?c(s.getCurrentCustomerList):((o=s.getCustomerLists)==null?void 0:o.length)===1&&c(s.getCustomerLists[0]))},p=e=>{var o;typeof e=="string"&&(e=((o=l.getLocations)==null?void 0:o.find(t=>t.id===e))??null),e!==null&&(e!==l.getCurrentLocation?(l.setCurrentLocation(e),u.value=l.getCurrentLocation,T(),w()):(B(),R()))},G=()=>{l.setLocations(void 0),f("locations",{method:"GET",onResponseError({response:e}){v(e)}}).then(e=>{var o;l.setLocations(e.locations),((o=l.getLocations)==null?void 0:o.length)===1&&p(l.getLocations[0])}).catch(e=>{L(e)})},I=()=>{u.value=void 0,l.reset(),G()},T=()=>{g.value=void 0,s.reset(),B()},w=()=>{r.value!==void 0&&(r.value=void 0,a.reset(),R())};return M(()=>{var e;E.value&&(l.getLocations===void 0?G():l.getCurrentLocation!==void 0?p(l.getCurrentLocation):((e=l.getLocations)==null?void 0:e.length)===1&&p(l.getLocations[0]))}),(e,o)=>(b(),N(j,null,[E.value?(b(),y($,{key:0,modelValue:u.value,"onUpdate:modelValue":[o[0]||(o[0]=t=>u.value=t),p],disabled:n(l).getLocations===void 0,items:n(l).getLocations,label:("$t"in e?e.$t:n(i))("page.order.add.button.location.label"),loading:n(l).getLocations===void 0,placeholder:("$t"in e?e.$t:n(i))("page.order.add.button.location.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":I},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0),S.value?(b(),y($,{key:1,modelValue:g.value,"onUpdate:modelValue":[o[1]||(o[1]=t=>g.value=t),c],disabled:n(s).getCustomerLists===void 0,items:n(s).getCustomerLists,label:("$t"in e?e.$t:n(i))("page.order.add.button.customerList.label"),loading:n(s).getCustomerLists===void 0,placeholder:("$t"in e?e.$t:n(i))("page.order.add.button.customerList.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":T},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0),k.value?(b(),y($,{key:2,modelValue:r.value,"onUpdate:modelValue":[o[2]||(o[2]=t=>r.value=t),m],disabled:n(a).getCatalogs===void 0,items:n(a).getCatalogs,label:("$t"in e?e.$t:n(i))("page.order.add.button.catalog.label"),loading:n(a).getCatalogs===void 0,placeholder:("$t"in e?e.$t:n(i))("page.order.add.button.catalog.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":w},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0)],64))}});export{P as _};
