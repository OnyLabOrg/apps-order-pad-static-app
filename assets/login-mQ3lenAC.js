import"./validators-BJEf8OaU.js";import{_ as B}from"./AppTextField.vue_vue_type_script_setup_true_lang-B2mPSrfQ.js";import{a as R,b as A}from"./auth-v1-top-shape-0NcaQZ_m.js";import{V as u}from"./VNodeRenderer-D9HSf8PR.js";import{d as $,r as d,u as q,j as P,b5 as r,bd as S,a$ as b,a as D,c as F,o as L,e as s,b as o,m as t,L as v,f as l,H as p,v as y,t as C,l as j,x as U}from"./index-B09WSrwZ.js";import{u as E}from"./useAbility-_xE7if6B.js";import{$ as H}from"./api-CFMSxRYS.js";import{a as M,c as z,V as I}from"./VCard-BnP7hiqm.js";import{V as k}from"./VCardText-JPi8_Q4U.js";import"./VRow-BmFi3LDc.js";import"./VCheckbox-B06c_xfe.js";import"./VDivider--z-03jdw.js";import"./helpers-BGv4x_9E.js";import"./form-BgBsQtI3.js";import"./VTextField-Dv0joo5r.js";/* empty css                   */import"./VCounter-CHnI__6i.js";import"./VImg-Dgujg1rK.js";import"./VField-1AgCrxKX.js";import"./easing-Bybner-F.js";import"./VInput-Cb5NoI7Z.js";import"./forwardRefs-C-GTDzx5.js";import"./index-CvOPxmL5.js";import"./VAvatar-BJaDydWO.js";/* empty css              */import"./VCheckboxBtn-BrcN2t7W.js";import"./VSelectionControl-BPVqWdvb.js";const O={class:"auth-wrapper d-flex align-center justify-center pa-4"},W={class:"position-relative my-sm-16"},G={class:"app-logo"},J={class:"app-logo-title"},K={class:"text-h4 mb-1"},Q={class:"text-capitalize"};const Se=$({__name:"login",async setup(X){let _,f;const Y=d(!1),c=q(),V=P(),h=E(),g=d({email:void 0,password:void 0}),N=d(),x=d({email:"",password:"",remember:!1}),T=async()=>{try{const e=await H("/auth/login",{method:"POST",body:{email:x.value.email,password:x.value.password},onResponseError({response:n}){g.value=n._data.errors}}),{accessToken:a,userData:i,userAbilityRules:m}=e;r("userAbilityRules",{maxAge:365*24*3600}).value=m,h.update(m),r("userData",{maxAge:365*24*3600}).value=i,r("accessToken",{maxAge:365*24*3600}).value=a,await b(()=>{V.replace(c.query.to?String(c.query.to):"/")})}catch(e){console.error(e)}},Z=()=>{var e;(e=N.value)==null||e.validate().then(({valid:a})=>{a&&T()})},w=r("jwt").value;if(typeof w=="string"){const e=w,a=[{action:"manage",subject:"all"}],i={id:1,fullName:"",username:"",avatar:"/images/avatars/avatar.png",email:"",role:"admin"};r("userAbilityRules",{}).value=a,h.update(a),r("userData").value=i,r("accessToken").value=e,[_,f]=S(()=>b(()=>{V.replace(c.query.to?String(c.query.to):"/")})),await _,f()}else window.location.href.includes("localhost")?window.location.href="http://localhost:8080/auth/?app=orderpad":window.location.href="https://login.apps.onylab.com/auth/?app=orderpad";return(e,a)=>{const i=D("RouterLink"),m=B;return L(),F("div",O,[s("div",W,[o(t(u),{nodes:("h"in e?e.h:t(v))("div",{innerHTML:t(R)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),o(t(u),{nodes:("h"in e?e.h:t(v))("div",{innerHTML:t(A)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),o(I,{class:U([e.$vuetify.display.smAndUp?"pa-6":"pa-0","auth-card"]),"max-width":"460"},{default:l(()=>[o(M,{class:"justify-center"},{default:l(()=>[o(z,null,{default:l(()=>[o(i,{to:"/"},{default:l(()=>[s("div",G,[o(t(u),{nodes:t(p).app.logo},null,8,["nodes"]),s("h1",J,y(t(p).app.title),1)])]),_:1})]),_:1})]),_:1}),o(k,null,{default:l(()=>[s("h4",K,[a[4]||(a[4]=C(" Welcome to ")),s("span",Q,y(t(p).app.title),1),a[5]||(a[5]=C("! 👋🏻 "))]),a[6]||(a[6]=s("p",{class:"mb-0"},null,-1))]),_:1,__:[6]}),o(k,null,{default:l(()=>[j("",!0)]),_:1})]),_:1},8,["class"])])])}}});export{Se as default};
