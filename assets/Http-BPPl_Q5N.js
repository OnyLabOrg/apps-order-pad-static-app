import{bf as d,cm as c,cn as g,co as L,b2 as i}from"./index-BCir9O6e.js";import{m as l}from"./mitt-DJ65BbbF.js";import{u as h,a as C,b as v}from"./catalog-7Ad44Kqc.js";import{u as w}from"./alert-DdALmCZ-.js";import{$ as u}from"./TranslationUtil-DpnqR49b.js";const m=()=>typeof window.navigator!="object"||typeof window.navigator.onLine!="boolean"?!0:window.navigator.onLine,n=()=>typeof document.hidden=="boolean"?document.hidden:typeof document.msHidden=="boolean"?document.msHidden:typeof document.webkitHidden=="boolean"?document.webkitHidden:!1,r=l(),b=d("userStore",{state:()=>({user:void 0}),getters:{getCurrentUser:e=>e.user},actions:{onCurrentUserChange(e){r.on("update:user",e),e(this.user)},offCurrentUserChange(e){r.off("update:user",e)},setCurrentUser(e){this.user=e,r.emit("update:user",this.user)},reset(){this.user=void 0,r.emit("update:user",this.user)}},persist:!0}),s=l(),y=d("customerListStore",{state:()=>({customerList:void 0,customerLists:void 0}),getters:{getCurrentCustomerList:e=>e.customerList,getCustomerLists:e=>e.customerLists},actions:{onCurrentCustomerListChange(e){s.on("update:customerList",e),e(this.customerList)},offCurrentCustomerListChange(e){s.off("update:customerList",e)},onCustomerListsChange(e){s.on("update:customerLists",e),e(this.customerLists)},offCustomerListsChange(e){s.off("update:customerLists",e)},setCurrentCustomerList(e){this.customerList=e,s.emit("update:customerList",this.customerList)},setCustomerLists(e){this.customerLists=e,s.emit("update:customerLists",this.customerLists)},reset(){this.customerList=void 0,s.emit("update:customerList",this.customerList),this.customerLists=void 0,s.emit("update:customerLists",this.customerLists)}},persist:!0});class f{static info(t,o){c(p=>{p.setExtra("context",Object.assign({isOnline:m(),isHidden:n()},o)),g(t)})}static exception(t){if(n()&&t.message!==void 0&&t.message!==null&&typeof t.message=="string"&&t.message.includes("timeout")||t.message!==void 0&&t.message!==null&&typeof t.message=="string"&&t.message.includes("status code 401"))return!1;c(o=>{o.setExtra("context",{isOnline:m(),isHidden:n()}),L(t)})}}const E=()=>{h().reset(),b().reset(),C().reset(),y().reset(),v().reset()},S=async(e,t)=>{i("jwt",{domain:".apps.onylab.com"}).value=null,i("accessToken").value=null,i("userData").value=null,i("userAbilityRules").value=null,E(),e!==void 0?await e.push("/login"):window.location.href="/",t!==void 0&&t.update([])},a=e=>(w().setAlert({title:e}),e),x=(e,t)=>!m()||typeof e.message=="string"&&e.message.includes("Network Error")?a(u("common.error.offline")):typeof e.message=="string"&&e.message.includes("timeout")?a(u("common.error.timeout")):(f.exception(e),a(u("common.error.default"))),O=async(e,t)=>{if(e.status===401){S().catch(f.exception);return}const o=new Error(e._data.message??"Request failed");return x(o)};export{x as a,y as b,E as c,O as h,S as l,b as u};
