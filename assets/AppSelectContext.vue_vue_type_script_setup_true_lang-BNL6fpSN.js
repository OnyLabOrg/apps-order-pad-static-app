import{$ as r}from"./TranslationUtil-CDY0a4uU.js";import{b as U,c as q,d as F,h as L,a as v}from"./Http-DyCMnVwC.js";import{$ as f}from"./api-CljGITsQ.js";import{V as $}from"./VSelect-C0M7Jt3m.js";import{d as A,r as i,G as M,c as N,F as j,g as y,l as V,m as n,o as b}from"./index-BTJzwLw-.js";const P=A({__name:"AppSelectContext",props:{enableLocations:{type:Boolean,default:()=>!1},enableCustomerLists:{type:Boolean,default:()=>!1},enableCatalogs:{type:Boolean,default:()=>!1}},setup(D){const h=D,E=i(h.enableLocations),S=i(h.enableCustomerLists),k=i(h.enableCatalogs),a=U(),s=q(),l=F(),d=i(),u=i(),c=i();d.value=a.getCurrentLocation,u.value=s.getCurrentCustomerList,c.value=l.getCurrentCatalog;const m=e=>{var o;typeof e=="string"&&(e=((o=s.getCustomerLists)==null?void 0:o.find(t=>t.id===e))??null),e!==null&&(s.setCurrentCustomerList(e),u.value=s.getCurrentCustomerList)},C=e=>{var o;typeof e=="string"&&(e=((o=l.getCatalogs)==null?void 0:o.find(t=>t.id===e))??null),e!==null&&f(`catalog?catalogId=${e.id}`,{method:"GET",onResponseError({response:t}){l.setCurrentCatalog(void 0),L(t)}}).then(t=>{l.setCurrentCatalog(t.catalog)}).catch(t=>{l.setCurrentCatalog(void 0),v(t)})},R=()=>{var e,o;k.value&&(l.getCatalogs===void 0?(l.setCatalogs(void 0),f(`catalogs?locationId=${(e=a.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:t}){L(t)}}).then(t=>{var g;l.setCatalogs(t.catalogs),((g=l.getCatalogs)==null?void 0:g.length)===1&&C(l.getCatalogs[0])}).catch(t=>{v(t)})):l.getCurrentCatalog!==void 0?C(l.getCurrentCatalog):((o=l.getCatalogs)==null?void 0:o.length)===1&&C(l.getCatalogs[0]))},B=()=>{var e,o;S.value&&(s.getCustomerLists===void 0?(s.setCustomerLists(void 0),f(`customers/list?locationId=${(e=a.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:t}){L(t)}}).then(t=>{var g;s.setCustomerLists(t.lists),((g=s.getCustomerLists)==null?void 0:g.length)===1&&m(s.getCustomerLists[0])}).catch(t=>{v(t)})):s.getCurrentCustomerList!==void 0?m(s.getCurrentCustomerList):((o=s.getCustomerLists)==null?void 0:o.length)===1&&m(s.getCustomerLists[0]))},p=e=>{var o;typeof e=="string"&&(e=((o=a.getLocations)==null?void 0:o.find(t=>t.id===e))??null),e!==null&&(e!==a.getCurrentLocation?(a.setCurrentLocation(e),d.value=a.getCurrentLocation,T(),w()):(B(),R()))},G=()=>{a.setLocations(void 0),f("locations",{method:"GET",onResponseError({response:e}){L(e)}}).then(e=>{var o;a.setLocations(e.locations),((o=a.getLocations)==null?void 0:o.length)===1&&p(a.getLocations[0])}).catch(e=>{v(e)})},I=()=>{d.value=void 0,a.reset(),G()},T=()=>{u.value=void 0,s.reset(),B()},w=()=>{c.value=void 0,l.reset(),R()};return M(()=>{var e;E.value&&(a.getLocations===void 0?G():a.getCurrentLocation!==void 0?p(a.getCurrentLocation):((e=a.getLocations)==null?void 0:e.length)===1&&p(a.getLocations[0]))}),(e,o)=>(b(),N(j,null,[E.value?(b(),y($,{key:0,modelValue:d.value,"onUpdate:modelValue":[o[0]||(o[0]=t=>d.value=t),p],disabled:n(a).getLocations===void 0,items:n(a).getLocations,label:("$t"in e?e.$t:n(r))("page.order.add.button.location.label"),loading:n(a).getLocations===void 0,placeholder:("$t"in e?e.$t:n(r))("page.order.add.button.location.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":I},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0),S.value?(b(),y($,{key:1,modelValue:u.value,"onUpdate:modelValue":[o[1]||(o[1]=t=>u.value=t),m],disabled:n(s).getCustomerLists===void 0,items:n(s).getCustomerLists,label:("$t"in e?e.$t:n(r))("page.order.add.button.customerList.label"),loading:n(s).getCustomerLists===void 0,placeholder:("$t"in e?e.$t:n(r))("page.order.add.button.customerList.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":T},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0),k.value?(b(),y($,{key:2,modelValue:c.value,"onUpdate:modelValue":[o[2]||(o[2]=t=>c.value=t),C],disabled:n(l).getCatalogs===void 0,items:n(l).getCatalogs,label:("$t"in e?e.$t:n(r))("page.order.add.button.catalog.label"),loading:n(l).getCatalogs===void 0,placeholder:("$t"in e?e.$t:n(r))("page.order.add.button.catalog.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":w},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0)],64))}});export{P as _};
